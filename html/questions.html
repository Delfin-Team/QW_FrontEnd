<!DOCTYPE html>
<html>
<head>
  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="../css/materialize.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <meta charset="utf-8">

  <title>Pregunta de la semana</title>

</head>
<body>
  <header>
    <nav class="nav-extended">
	    <div class="nav-wrapper indigo accent-3">
	      <a href="questions.html" class="brand-logo">&nbsp Pregunta de la Semana</a>
	      <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>
	      <ul id="nav-mobile" class="right hide-on-med-and-down">
	        <li><a href="propose.html">Proponer</a></li>
	        <li><a href="winquestions.html">Preguntas ganadoras</a></li>
	        <li><a href="votes.html">Votos</a></li>
	        <li><a href="groups.html">Grupos</a></li>
	        <li><a href="index.html">Salir</a></li>
	      </ul>
	      <ul class="side-nav" id="mobile-demo">
	        <li><a href="propose.html"><i class="material-icons">lightbulb_outline</i>Proponer</a></li>
	        <li><a href="winquestions.html"><i class="material-icons">timeline</i>Preguntas ganadoras</a></li>
	        <li><a href="votes.html"><i class="material-icons">thumbs_up_down</i>Votos</a></li>
	        <li><a href="groups.html"><i class="material-icons">group</i>Grupos</a></li>
	        <li><a href="index.html"><i class="material-icons">exit_to_app</i>Salir</a></li>
	      </ul>
	    </div>
	  </nav>
  </header>

  <BR>
  <div class="center-align ">
    <h1><font color="#b71c1c">Pregunta de la semana</font></h1>
  </div>

  <div class="container blue lighten-5 z-depth-3" id="cardQuestion">
    <h4 class="indigo center-align"><font color="white" id="titleQuestion" ></font></h4>
    <div class="container border-radius: 10px">
      <div class="row">
        <div class="col s9 offset s3">
          <!--Materialize Components Forms-->
          <div class="row">
            <form class="col s12">

              <div class="row">
                <h5><i class="material-icons">face</i>  Creador:</h5>
                <h5 id="created"><i class="material-icons">schedule</i> Creado:</h5>
                <h5 id="totalVotes"><i class="material-icons">star</i> Votos: &nbsp</h5>
              </div>

              <div class="row">
                <hr>
                <div class="input-field col s12">
                  <button class="btn btn-waves" id="btnQuestion" name="">Responder</button>
                  <br>
                  <br>
                  <h6><a href="graphicsquestion.html"><i class="material-icons">show_chart</i> Ver votos</a></h6>
                </div>
              </div>

            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--answers-->
  <div class="container blue lighten-5 z-depth-3" id="answersList">
    <h5 class="indigo center-align"><font color="white">Elige una respuesta</font></h5>
    <div class="container">
      <div class="row">
        <div class="col s6 offset s3">
          <!--Materialize Components Forms-->
          <div class="row">
            <form class="col s12">

              <div class="row">

                    <div id="divAnswers">

                    </div>

              </div>

              <div class="row">
                <span class="col s3 offset s7">
                  <button class="btn waves-effect waves-light z-depth-5" type="submit" name="action">Responder</button>
                </span>
              </div>

            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!--end-->

  <hr>

    <div id="loadProposedQuestions" >
      <ul class="collection with-header">
        <li class="collection-header"><h4>Preguntas propuestas</h4></li>
        <div id="addToList">

        </div>
      </ul>
    </div>

  <!--jQuery before JS-->
  <script src="../js/jquery.min.js"></script>
  <!-- Compiled and minified JavaScript -->
  <script src="../js/materialize.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function()    {
      $("#answersList").hide();
      $("#btnQuestion").on('click',function(e){
        e.preventDefault();
        var currentId = $(this).attr("name");
        $("#cardQuestion").hide("slow");
        $("#answersList").show();
        console.log(currentId);
        $.ajax({
            // la URL para la petición
            url : 'http://198.199.80.27/api/questions/' + currentId,
            type : 'GET',
            dataType : 'json',

            success : function(json) {

                $.each(json.answers,function(i, item){
                  var formxD = $("#divAnswers");
                  console.log(json.answers[i].description);
                  formxD.append('<p>\
                    <input class="with-gap" name="answer" type="radio" id="'+json.answers[i].id+'" />\
                    <label for="'+json.answers[i].id+'">'+json.answers[i].description+'</label>\
                  </p>\
                  ');
                  /*
                  <p>
                    <input class="with-gap" name="group1" type="radio" id="test1" />
                    <label for="test1">Red</label>
                  </p>
                  */


                });
            },


            error : function(xhr, status) {
                console.log("error")
            },


            complete : function(xhr, status) {
                console.log("done");
            }
        });
      });


                //week's question
          $.ajax({
              // la URL para la petición
              url : 'http://198.199.80.27/api/questionweek',
              type : 'GET',
              dataType : 'json',

              success : function(json) {

                  $("#titleQuestion").append(json.question.title);
                  $("#totalVotes").append(json.question.votes);
                  $("#created").append(json.question.created_at);
                  $("#btnQuestion").attr('name',json.question.id);
              },


              error : function(xhr, status) {
                  console.log("error")
              },


              complete : function(xhr, status) {
                  console.log("done");
              }
          });
          $.ajax({
              // la URL para la petición
              url : 'http://198.199.80.27/api/questions',
              type : 'GET',
              dataType : 'json',

              success : function(json) {

                  $.each(json,function(i, item){
                    $("#addToList").append('<li class="collection-item"><div>"'+json[i].title+'"<a href="http://198.199.80.27/api/questions/'+json[i].id+'" class="secondary-content"><i class="material-icons">send</i></a></div></li>');


                  });
              },


              error : function(xhr, status) {
                  console.log("error")
              },


              complete : function(xhr, status) {
                  console.log("done");
              }
          });

    })
  </script>

</body>
</html>
